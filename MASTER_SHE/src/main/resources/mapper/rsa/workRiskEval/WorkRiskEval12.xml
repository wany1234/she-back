<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace= "com.she.rsa.workRiskEval.mapper.WorkRiskEval12Mapper">

    <!-- 작업위험성평가 단위작업 목록 조회 -->
    <select id= "getworkRiskEval12Lists" resultType= "com.she.rsa.model.WorkRiskEval12RefInd">
    /* WorkRiskEval12Mapper.getworkRiskEval12Lists [WorkRiskEval12.xml] */
       select 
             a.plant_cd
           , b.code_nm as plant_nm
           , a.ind_type_cd
           , c.code_nm as ind_type_nm
           , a.set_val
           , a.set_nm
           , a.sort_order
           , a.use_yn
       from rsa_ref_ind a  
       inner join dbo.LANG_CODE_MASTER(#{defaultParam.lang}, 'COM_PLANT_CD') b
            on a.plant_cd = b.code
       inner join dbo.LANG_CODE_MASTER(#{defaultParam.lang}, 'SAF_RSA_IND_TYPE') c
            on a.ind_type_cd = c.code
       where 1=1
           <if test= "plantCd != null and !plantCd.equals('')">
             and a.plant_cd = #{plantCd}
           </if>    
           <if test= "indTypeCd != null and !indTypeCd.equals('')">
             and a.ind_type_cd = #{indTypeCd}
           </if>
           <if test= "useYn != null and !useYn.equals('')">
             and a.use_yn = #{useYn}
           </if>
           <if test= "setNm != null and !setNm.equals('')">
             and a.set_nm like '%' + #{setNm} + '%'
           </if>
        order by a.plant_cd, a.ind_type_cd, a.sort_order
    </select>
    
    <!-- 작업위험성평가 단위작업 등록 -->
    <insert id ="createWorkRiskEval12" parameterType= "com.she.rsa.model.WorkRiskEval12RefInd">
    /* WorkRiskEval12Mapper.createWorkRiskEval12 [WorkRiskEval12.xml] */
       insert into rsa_ref_ind
        (
             plant_cd
           , ind_type_cd
           , set_val
           , set_nm
           , desc1
           , desc2
           , desc3
           , desc4
           , desc5
           , sort_order
           , use_yn
           , create_user_id
           , create_dt
           , update_user_id
           , update_dt
        )
        values
        (
             #{plantCd}
           , #{indTypeCd}
           , #{setVal}
           , #{setNm}
           , #{desc1}
           , #{desc2}
           , #{desc3}
           , #{desc4}
           , #{desc5}
           , #{sortOrder}
           , #{useYn}
           , #{createUserId}
           , getdate()
           , #{updateUserId}
           , getdate()
        )
    </insert>
    
    <!-- 작업위험성평가 단위작업 수정 -->
    <update id= "updateWorkRiskEval12" parameterType= "com.she.rsa.model.WorkRiskEval12RefInd">
        /* WorkRiskEval12Mapper.updateWorkRiskEval12 [WorkRiskEval12.xml] */
        update rsa_ref_ind
          set  set_nm           = #{setNm}
             , desc1            = #{desc1}
             , desc2            = #{desc2}
             , desc3            = #{desc3}
             , desc4            = #{desc4}
             , desc5            = #{desc5}
             , sort_order       = #{sortOrder}
             , use_yn           = #{useYn}
             , update_user_id   = #{updateUserId}
             , update_dt        = getdate()
          where plant_cd        = #{plantCd}
            and ind_type_cd     = #{indTypeCd}
            and set_val         = #{setVal}
    </update>
    
    <select id= "getWorkRiskEval12Info" resultType= "com.she.rsa.model.WorkRiskEval12RefInd">
        /* WorkRiskEval12Mapper.getWorkRiskEval12Info [WorkRiskEval12.xml] */
        select a.plant_cd
             , a.ind_type_cd
             , a.set_val               
             , a.set_nm
             , a.desc1
             , a.desc2
             , a.desc3
             , a.desc4
             , a.desc5
             , a.sort_order
             , a.use_yn
       from rsa_ref_ind a
       where 1=1
        and a.plant_cd      = #{plantCd}
        and a.ind_type_cd   = #{indTypeCd}
        and a.set_val       = #{setVal}
    </select>

</mapper>