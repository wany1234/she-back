<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace= "com.she.rsa.workRiskEval.mapper.WorkRiskEval11Mapper">

    <!-- 작업위험성평가 단위작업 목록 조회 -->
    <select id= "getworkRiskEval11Lists" resultType= "com.she.rsa.model.WorkRiskEval11UnitWork">
    /* WorkRiskEval11Mapper.getworkRiskEval11Lists [WorkRiskEval11.xml] */
       select 
             a.plant_cd
           , b.code_nm as plant_nm
           , a.unit_work_cd
           , a.unit_work_nm
           , a.remark
           , a.sort_order
           , a.use_yn
       from rsa_unit_work a  
       inner join dbo.LANG_CODE_MASTER(#{defaultParam.lang}, 'COM_PLANT_CD') b
            on a.plant_cd = b.code
       where 1=1
           <if test= "plantCd != null and !plantCd.equals('')">
             and a.plant_cd = #{plantCd}
           </if>    
           <if test= "useYn != null and !useYn.equals('')">
             and a.use_yn = #{useYn}
           </if>
           <if test= "unitWorkNm != null and !unitWorkNm.equals('')">
             and a.unit_work_nm like '%' + #{unitWorkNm} + '%'
           </if>
        order by a.sort_order
    </select>
    
    <!-- 작업위험성평가 단위작업 등록 -->
    <insert id ="createWorkRiskEval11" parameterType= "com.she.rsa.model.WorkRiskEval11UnitWork">
    /* WorkRiskEval11Mapper.createWorkRiskEval11 [WorkRiskEval11.xml] */
       insert into rsa_unit_work
        (
             plant_cd
           , unit_work_cd
           , unit_work_nm
           , remark
           , sort_order
           , use_yn
           , create_user_id
           , create_dt
           , update_user_id
           , update_dt
        )
        values
        (
             #{plantCd}
           , #{unitWorkCd}
           , #{unitWorkNm}
           , #{remark}
           , #{sortOrder}
           , #{useYn}
           , #{createUserId}
           , getdate()
           , #{updateUserId}
           , getdate()
        )
    </insert>
    
    <!-- 작업위험성평가 단위작업 수정 -->
    <update id= "updateWorkRiskEval11" parameterType= "com.she.rsa.model.WorkRiskEval11UnitWork">
        /* WorkRiskEval11Mapper.updateWorkRiskEval11 [WorkRiskEval11.xml] */
        update rsa_unit_work
          set  unit_work_nm     = #{unitWorkNm}
             , remark           = #{remark}
             , sort_order       = #{sortOrder}
             , use_yn           = #{useYn}
             , update_user_id   = #{updateUserId}
             , update_dt        = getdate()
          where plant_cd        = #{plantCd}
            and unit_work_cd    = #{unitWorkCd}
    </update>
    
    <select id= "getWorkRiskEval11Info" resultType= "com.she.rsa.model.WorkRiskEval11UnitWork">
        /* WorkRiskEval11Mapper.getWorkRiskEval11Info [WorkRiskEval11.xml] */
        select 
               a.plant_cd
             , a.unit_work_cd
             , a.unit_work_nm
             , a.remark
             , a.sort_order
             , a.use_yn
       from rsa_unit_work a
       where 1=1
        and a.plant_cd      = #{plantCd}
        and a.unit_work_cd  = #{unitWorkCd}
    </select>

</mapper>